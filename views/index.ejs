<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>OnlyPogs</title>
</head>
<script>

    // Takes the rows passed from main.js and stringify's it in order for it to work
    var data = <%- JSON.stringify(rows) %>;

    // console.log(data)
    // Define a variable to store the current sort order
    var currentSortOrder = 'asc';

    // Define a function to toggle the sort order
    function toggleSortOrder() {
        currentSortOrder = currentSortOrder === 'asc' ? 'desc' : 'asc';
    }

    // Define a function to sort the table by the "Name" column
    function sortByName() {
        toggleSortOrder();

        data.sort((a, b) => {
            const comparison = a.name.localeCompare(b.name);
            return currentSortOrder === 'asc' ? comparison : -comparison;
        });

        // Call a function to update the table rows
        updateTable();
    }

    // Define a function to update the table rows based on the sorted data
    function updateTable() {
        const tableBody = document.getElementById('table');
        const tableHead = document.getElementById('tableHead');
        tableBody.innerHTML = '';
        tableHead.innerHTML = '';
        data.forEach((row) => {
            
            const tHead = table.createTHead()
            const th = document.createElement('th')
            const thName = document.createElement('th')
            const thSerial = document.createElement('th')
            const thAmount = document.createElement('th')
            const thTags = document.createElement('th')

            const tr = document.createElement('tr');
            const tdName = document.createElement('td');
            const tdSerial = document.createElement('td');
            const tdAmount = document.createElement('td');
            const tdTags = document.createElement('td');

            thName.textContent = "Name"
            thSerial.textContent = "Serial"
            thAmount.textContent = "Amount"
            thTags.textContent = "Tags"

            tdName.textContent = row.name;
            tdSerial.textContent = row.serial;
            tdAmount.textContent = row.amount;
            tdTags.textContent = row.tags;

            tHead.appendChild(thName)
            tHead.appendChild(thSerial)
            tHead.appendChild(thAmount)
            tHead.appendChild(thTags)
            tr.appendChild(tdName);
            tr.appendChild(tdSerial);
            tr.appendChild(tdAmount);
            tr.appendChild(tdTags);

            tableHead.appendChild(tHead)
            tableBody.appendChild(tableHead)
            
            tableBody.appendChild(tr);
        });
    }
</script>

<body>

    <!-- each header has it's own onclick function with the arguement to each collumn to sort to  -->
    <button><a href="/acc">Account</a></button>
    <table id="table">
        <thead id="tableHead">
            <th id="name" onclick="sortByName()">Name --</th>
            <th onclick="reOrder('Serial')" id="serial">Serial Number --</th>
            <th onclick="reOrder('Amount')" id="amount">Amount Produced --</th>
            <th onclick="reOrder('Tags')" id="tags">Tags --</th>
            
        </thead>

        <% for(let i=0; i < rows.length; i++) {%>
            <tr>
                <td>
                    <a href="<%- rows[i].url %>"><%- rows[i].name %></a>
                    <!-- <%- rows[i].name %> -->
                </td>

                <td>
                    <%- rows[i].serial %>
                </td>
                <td>
                    <%- rows[i].amount %>
                </td>
                <td>
                    <%- rows[i].tags %>
                </td>
            </tr>
            <% } %>
    </table>

</body>

</html>